source("google_api.R", encoding = "utf-8")
price <- read.csv("house_price.csv")
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
View(df)
View(price)
which(price[,5] == "高雄市")
which(price[,9] == "高雄市")
price_use <- price[which(price[,9] == "高雄市"),]
price_use$lat
latlng_distance <- function(lat1,lon1,lat2,lon2){
d = (lat1-lat2)^2+(lon1-lon2)^2
return(d)
}
View(df)
View(df)
latlng_distance(df$Var1,df$Var2,price_use$lat,price_use$lon)
latlng_distance(df$Var1,df$Var2,price_use$lat,price_use$lon)
latlng_distance(df$Var1,df$Var2,price_use$lat,price_use$lon)
length(latlng_distance(df$Var1,df$Var2,price_use$lat,price_use$lon))
latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon)
min(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon))
which.min(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon))
View(price_use)
View(price_use)
price_use[ 2754,]
View(price_use)
174032
which.min(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon))
which(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon))
sort(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon))
which(sort(latlng_distance(df$Var1[1],df$Var2[1],price_use$lat,price_use$lon)))
price_use <- price[which(price[,9] == city),]
city = "高雄市"
price_use <- price[which(price[,9] == city),]
View(price_use)
lat2 = price_use$lat
lon2 = price_use$lon
d = (lat1-lat2)^2+(lon1-lon2)^2
lon1 <- df$Var2
lat1 <- df$Var1
d = (lat1-lat2)^2+(lon1-lon2)^2
order(d)
price_use <- order(d)
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
d = (lat1-lat2)^2+(lon1-lon2)^2
price_use$order <- order(d)
View(price_use)
sort(d)
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
View(price_use)
price_use1 <- price_use[order(price_use$d),]
View(price_use1)
View(price_use)
price_use$單價元平方公尺
return(d)
price_use$"單價元平方公尺"
price_use <- price_use[order(price_use$d),]
price_use$"單價元平方公尺"[1:10]
mean(price_use$"單價元平方公尺"[1:10])
latlng_distance <- function(lat1,lon1,city){
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
return(mean(price_use$"單價元平方公尺"[1:10]))
}
latlng_price <- function(lat1,lon1,city){
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
return(mean(price_use$"單價元平方公尺"[1:10]))
}
latlng_price(df$Var1,df$Var2,"高雄市")
latlng_price(df$Var1[1],df$Var2[1],"高雄市")
latlng_price(df$Var1[2],df$Var2[2],"高雄市")
latlng_price(df$Var1[3],df$Var2[3],"高雄市")
city = "高雄市"
lat1 <- df$Var1
lon1 <- df$Var2
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
View(price_use)
mean(price_use$"單價元平方公尺"[1:10])
latlng_price <- function(lat1,lon1,city){
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
return(mean(price_use$"單價元平方公尺"[1:10]))
}
lat1 <- df$Var1[1]
lon1 <- df$Var2[1]
latlng_price <- function(lat1,lon1,city){
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
return(mean(price_use$"單價元平方公尺"[1:10]))
}
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
mean(price_use$"單價元平方公尺"[1:10])
mean(price_use$"單價元平方公尺"[1:10])
mean(price_use$"單價元平方公尺"[1:10])
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
mean(price_use$"單價元平方公尺"[1:10])
View(price_use1)
View(price_use)
lat1 <- df$Var1[1]
lon1 <- df$Var2[1]
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
mean(price_use$"單價元平方公尺"[1:10])
View(price_use)
View(price_use1)
View(price_use)
city = "高雄市"
lat1 <- df$Var1[1]
lon1 <- df$Var2[1]
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
mean(price_use$"單價元平方公尺"[1:10])
View(price_use)
price_use$"單價元平方公尺"[1:10]
sort(price_use$"單價元平方公尺"[1:10])
sort(price_use$"單價元平方公尺"[1:10])[3:8]
mean(sort(price_use$"單價元平方公尺"[1:10])[3:8])
latlng_price <- function(lat1,lon1,city){
price_use <- price[which(price[,9] == city),]
lat2 = price_use$lat
lon2 = price_use$lon
price_use$d = (lat1-lat2)^2+(lon1-lon2)^2
price_use <- price_use[order(price_use$d),]
return(mean(sort(price_use$"單價元平方公尺"[1:10])[3:8]))
}
df$price <- latlng_price(df$Var1,df$Var2,df$city)
View(df)
for(i in c(1:length(df))){df$price[i] <- latlng_price(df$Var1[i],df$Var2[i],df$city[i])}
View(df)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
View(df)
View(df)
df$price <- 0
View(df)
for(j in c(1:length(df))){df$price[j] <- latlng_price(df$Var1[j],df$Var2[j],df$city[j])}
View(df)
df$price <- 0
for(j in c(1:length(df))){df$price[j] <- latlng_price(df$Var1[j],df$Var2[j],df$city[j])}
length(df)
nrow(df)
source("google_api.R", encoding = "utf-8")
price <- read.csv("house_price.csv")
View(price)
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
View(df)
source("google_api.R", encoding = "utf-8")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,100,0,0,0,0,0,0)
df <- town_ltd_info("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source('C:/Users/Jupiter/OneDrive - student.nsysu.edu.tw/Educations/Contests/2020gov_contest_data/town_moi/rscript/google_api_example.R', encoding = 'UTF-8', echo=TRUE)
View(df)
gmaps$places_nearby(keyword="clinic",location = c(22.62631,120.2846), radius=0.001)
gmaps$places_nearby(keyword="clinic",location = c(22.62631,120.2846), radius=0.000001)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
View(df)
requests <- import("requests")
source("google_api.R", encoding = "utf-8")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
df <- town_ltd_info("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
View(df)
df$info <- paste(sep = "<br/>",
"診所個數:",df3$clinc,
"地區醫院個數:",df3$hospital,
"醫學中心個數:",df3$hospital_center,
"公園個數:",df3$park,
"圖書館個數:",df3$library,
"捷運站出口個數:",df3$mrt_station,
"公車站牌個數:",df3$bus_stop,
"110老化指數:",df3[,46])
View(df)
df$info <- paste(sep = "<br/>",
"診所個數:",df$clinc,
"地區醫院個數:",df$hospital,
"醫學中心個數:",df$hospital_center,
"公園個數:",df$park,
"圖書館個數:",df$library,
"捷運站出口個數:",df$mrt_station,
"公車站牌個數:",df$bus_stop,
"110老化指數:",df[,46])
View(df)
df$info <- paste(sep = "<br/>")
if(num1 != 0){df$info <- paste("診所個數:",df$clinc)}
if(num2 != 0){df$info <- paste("地區醫院個數:",df$hospital)}
if(num3 != 0){df$info <- paste("醫學中心個數:",df$hospital_center)}
if(num4 != 0){df$info <- paste("公園個數:",df$park)}
if(num5 != 0){df$info <- paste("圖書館個數:",df$library)}
if(num6 != 0){df$info <- paste("捷運站出口個數:",df$mrt_station)}
if(num7 != 0){df$info <- paste("公車站牌個數:",df$bus_stop)}
df$info <- paste("110老化指數:",df[,46])
num = c(0,1000,5000,300,300,500,100)
num[1]
df$info <- paste(sep = "<br/>")
if(num[1] != 0){df$info <- paste("診所個數:",df$clinc)}
if(num[2] != 0){df$info <- paste("地區醫院個數:",df$hospital)}
if(num[3] != 0){df$info <- paste("醫學中心個數:",df$hospital_center)}
if(num[4] != 0){df$info <- paste("公園個數:",df$park)}
if(num[5] != 0){df$info <- paste("圖書館個數:",df$library)}
if(num[6] != 0){df$info <- paste("捷運站出口個數:",df$mrt_station)}
if(num[7] != 0){df$info <- paste("公車站牌個數:",df$bus_stop)}
df$info <- paste("110老化指數:",df[,46])
df$info
df$info <- paste(sep = "<br/>")
df$info <- paste(sep = "<br/>")
df$info <- 0
df$info <- paste(sep = "<br/>")
df$info <- paste(sep = "<br/>")
if(num[1] != 0){df$info <- paste("診所個數:",df$clinc)}
if(num[2] != 0){df$info <- paste("地區醫院個數:",df$hospital)}
if(num[3] != 0){df$info <- paste("醫學中心個數:",df$hospital_center)}
if(num[4] != 0){df$info <- paste("公園個數:",df$park)}
if(num[5] != 0){df$info <- paste("圖書館個數:",df$library)}
if(num[6] != 0){df$info <- paste("捷運站出口個數:",df$mrt_station)}
if(num[7] != 0){df$info <- paste("公車站牌個數:",df$bus_stop)}
df$info <- paste("110老化指數:",df[,46])
if(num[1] != 0){df$info <- paste("診所個數:",df$clinc)}
df$info
if(num[2] != 0){df$info <- paste("地區醫院個數:",df$hospital)}
df$info
df$info <- paste(" ",sep = "<br/>")
if(num[1] != 0){df$info <- paste(df$info,"診所個數:",df$clinc)}
if(num[2] != 0){df$info <- paste(df$info,"地區醫院個數:",df$hospital)}
if(num[3] != 0){df$info <- paste(df$info,"醫學中心個數:",df$hospital_center)}
if(num[4] != 0){df$info <- paste(df$info,"公園個數:",df$park)}
if(num[5] != 0){df$info <- paste(df$info,"圖書館個數:",df$library)}
if(num[6] != 0){df$info <- paste(df$info,"捷運站出口個數:",df$mrt_station)}
if(num[7] != 0){df$info <- paste(df$info,"公車站牌個數:",df$bus_stop)}
df$info <- paste(df$info,"110老化指數:",df[,46])
df$info
df$info <- 0
df$info <- paste(sep = "<br/>",
"診所個數:",df$clinc,
"地區醫院個數:",df$hospital,
"醫學中心個數:",df$hospital_center,
"公園個數:",df$park,
"圖書館個數:",df$library,
"捷運站出口個數:",df$mrt_station,
"公車站牌個數:",df$bus_stop,
"110老化指數:",df[,46])
df$info
df$info[1]
df$info <- 0
if(num[1] != 0){df$info <- paste(df$info,"診所個數:",df$clinc,"<br/>")}
if(num[2] != 0){df$info <- paste(df$info,"地區醫院個數:",df$hospital,"<br/>")}
if(num[3] != 0){df$info <- paste(df$info,"醫學中心個數:",df$hospital_center,"<br/>")}
if(num[4] != 0){df$info <- paste(df$info,"公園個數:",df$park,"<br/>")}
if(num[5] != 0){df$info <- paste(df$info,"圖書館個數:",df$library,"<br/>")}
if(num[6] != 0){df$info <- paste(df$info,"捷運站出口個數:",df$mrt_station,"<br/>")}
if(num[7] != 0){df$info <- paste(df$info,"公車站牌個數:",df$bus_stop,"<br/>")}
df$info <- paste(df$info,"110老化指數:",df[,46])
df$info[1]
df$info <- 0
if(num[1] != 0){df$info <- paste0(df$info,"診所個數:",df$clinc,"<br/>")}
if(num[2] != 0){df$info <- paste0(df$info,"地區醫院個數:",df$hospital,"<br/>")}
if(num[3] != 0){df$info <- paste0(df$info,"醫學中心個數:",df$hospital_center,"<br/>")}
if(num[4] != 0){df$info <- paste0(df$info,"公園個數:",df$park,"<br/>")}
if(num[5] != 0){df$info <- paste0(df$info,"圖書館個數:",df$library,"<br/>")}
if(num[6] != 0){df$info <- paste0(df$info,"捷運站出口個數:",df$mrt_station,"<br/>")}
if(num[7] != 0){df$info <- paste0(df$info,"公車站牌個數:",df$bus_stop,"<br/>")}
df$info <- paste0(df$info,"110老化指數:",df[,46])
df$info[1]
if(num[1] != 0){df$info <- c(df$info,"診所個數:",df$clinc,"<br/>")}
if(num[2] != 0){df$info <- paste0(df$info,"地區醫院個數:",df$hospital,"<br/>")}
if(num[3] != 0){df$info <- paste0(df$info,"醫學中心個數:",df$hospital_center,"<br/>")}
if(num[4] != 0){df$info <- paste0(df$info,"公園個數:",df$park,"<br/>")}
if(num[5] != 0){df$info <- paste0(df$info,"圖書館個數:",df$library,"<br/>")}
if(num[6] != 0){df$info <- paste0(df$info,"捷運站出口個數:",df$mrt_station,"<br/>")}
if(num[7] != 0){df$info <- paste0(df$info,"公車站牌個數:",df$bus_stop,"<br/>")}
df$info <- paste0(df$info,"110老化指數:",df[,46])
df$info[1]
df$info <- vector()
if(num[1] != 0){df$info <- c(df$info,"診所個數:",df$clinc,"<br/>")}
if(num[2] != 0){df$info <- paste0(df$info,"地區醫院個數:",df$hospital,"<br/>")}
if(num[3] != 0){df$info <- paste0(df$info,"醫學中心個數:",df$hospital_center,"<br/>")}
if(num[4] != 0){df$info <- paste0(df$info,"公園個數:",df$park,"<br/>")}
if(num[5] != 0){df$info <- paste0(df$info,"圖書館個數:",df$library,"<br/>")}
if(num[6] != 0){df$info <- paste0(df$info,"捷運站出口個數:",df$mrt_station,"<br/>")}
if(num[7] != 0){df$info <- paste0(df$info,"公車站牌個數:",df$bus_stop,"<br/>")}
df$info <- paste0(df$info,"110老化指數:",df[,46])
df$info[1]
df$info <- vector()
df$info <- vector()
df$info <- c(" ")
if(num[1] != 0){df$info <- c(df$info,"診所個數:",df$clinc,"<br/>")}
df$info[1]
if(num[2] != 0){df$info <- paste0(df$info,"地區醫院個數:",df$hospital,"<br/>")}
df$info[1]
df$info <- c("")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,100,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
# combine the population data
dep <- read.csv("2020Data_final.csv")
View(dep)
df <- town_ltd_info("高雄市","鹽埕區",5000,0,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
df <- town_ltd_info("高雄市","鹽埕區",5000,0,1000,5000,300,300,500,100)
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",5000,0,1000,5000,300,300,500,100)
ltd = read_sf("./TOWN_MOI_1090324.shp")
googlemaps <- import("googlemaps")
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
View(df)
View(df)
View(df)
df3$index <- nor.min.max(rowSums(nor.min.max(df3[,c(3:11,46)])))*0.8+0
df$index <- nor.min.max(rowSums(nor.min.max(df[,c(3:11,46)])))*0.8+0
df$index <- nor.min.max(rowSums(nor.min.max(df[,c(3:11,46)])))*0.8+0.1
df[,c(3:11,46)])
df[,c(3:11,46)]
rowSums(nor.min.max(df3[,c(3:11,46)])
)
df$index <- nor.min.max(rowSums(nor.min.max(df[,c(3:11,46)])))*0.8+0.1
nor.min.max(rowSums(nor.min.max(df[,c(3:11,46)])))*0.8+0.1
rowSums(nor.min.max(df[,c(3:11,46)]))
nor.min.max(df[,c(3:11,46)])
nor.min.max(df[,c(3)])
(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)
nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)
scale(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)
scale(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)
nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)
0.8*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.1)
df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop
0.6*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.3)
df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop
0.5*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.5)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.5)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.7)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+0.9)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1)
df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)/1.5
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)/2
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)/3
df[,14]+df[,16]
(3*df[,14]+7*df[,16])
(3*df[,14]+7*df[,16])0.05
(3*df[,14]+7*df[,16])*0.05
(3*df[,14]+7*df[,16])*0.005
(3*df[,14]+7*df[,16])*0.002
(3*df[,14]+7*df[,16])*0.003
(3*df[,14]+7*df[,16])*0.004
nor.min.max(df$price)
0.3*nor.min.max(df$price)
0.2*(nor.min.max(df$price)+1.5)
0.1*(nor.min.max(df$price)+1.5)
0.05*(nor.min.max(df$price)+1.5)
0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)/3+(3*df[,14]+7*df[,16])*0.003-0.05*(nor.min.max(df$price)+1.5)
df$index <- 0.3*(nor.min.max(df$clinc+df$hospital+df$hospital_center+df$park+df$library+df$mrt_station+df$bus_stop)+1.5)/3+(3*df[,14]+7*df[,16])*0.003-0.05*(nor.min.max(df$price)+1.5)
df$index
source("google_api.R", encoding = "utf-8")
df <- town_ltd_info("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
View(df)
# city, town, radius, clinc, hospital, hospital_center, park, library, mrt_station,bus_stop
town_location_draw("高雄市","鹽埕區",500,0,1000,5000,300,300,500,100)
